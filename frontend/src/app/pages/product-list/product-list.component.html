<header class="z-50 sticky top-0">
    <app-header></app-header>
</header>

<section class="min-h-[100vh] flex flex-col justify-center items-center pt-[50px]">    
    <div class="flex flex-row align-center justify-center gap-10">
        <div class=" z-10 mb-10">
            <app-search-bar (newItemEvent)="getSearchedProducts($event)"
                [query]="this.querySelector.search"></app-search-bar>
        </div>

        <div>
            <select id="order-by" class=" cursor-pointer" (change)="order()">
                <option value="name-asc">Nombre ascendente</option>
                <option value="name-desc">Nombre descendiente</option>
                <option value="price-asc">Precio ascendente</option>
                <option value="price-desc">Precio descendiente</option>
            </select>
        </div>
    </div>


    @if (allProducts != null){
    <div id="product-list">
        @for (product of allProducts; track product.id) {

        <div class="block w-full h-auto rounded shadow-4xl bg-[#253125] text-[#e3f08f] font-bold p-4">
            <div class=" text-center text-2xl mb-4">{{product.name}}</div>
            <img class="w-full h-48 object-cover" [src]="product.images[0]">
            <div class="product-card-price">Precio : {{product.price | eurosToCents }}</div>
            <p>{{ product.average | number:'1.1-1' }} <i class="fa-regular fa-star fa-flip fa-lg"
                    style="color: #FFD43B;"></i> ({{product.reviews.length}})</p>
            @if (product.stock > 0) {
            <div class="product-card-stock">Stock: {{ product.stock }} KG</div>
            }
            @else {
            <div class="text-[#9A2215]">No hay stock</div>
            }
            <button class="product-card-button" (click)="shoppingCartService.addToCart(product)">Añadir al carrito </button>
        </div>
        }
    </div>
    }@else {
    <div class="loading ">Cargando...</div>
    }
    @if (allProducts?.length == 0 || allProducts == null){
    <img class=" block w-[30%] h-auto " src="/assets/productList/product-not-found.png" alt="product not found">
    }

    <div id="pagination" class="bottom-0 mt-20 mb-2 rounded-md flex justify-center items-center bg-[#253125] text-[#e3f08f] font-bold p-4 gap-4">
        <button (click)="goToFirstPage()" id="first-button">&lt;&lt;</button>
        <button id="prev-button" (click)="previousPage()">&lt;</button>
        <div id="pagination-numbers" class="text-[#e3f08f] ">
            @if(totalPages == 0)
            {
            <p>0 de 0</p>
            }
            @else
            {
            <p>{{ currentPage }} de {{ totalPages }}</p>
            }
        </div>
        <button id="next-button" (click)="nextPage()">&gt;</button>
        <button (click)="goToLastPage()" id="last-button">&gt; &gt;</button>

        <!-- Selector para elegir el número de productos por página -->
        <select class=" text-[#253125]" (change)="newNumberOfProducts()">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
        </select>
    </div>
</section>